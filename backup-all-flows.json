[{"id":"91e347de.036768","type":"function","z":"3be80343.efbc94","name":"calculate cost","func":"\n\ningredientsDB = msg.payload.ingredientsDB;\ningredients = msg.payload.ingredients\n\n\nn_ingredients = ingredients.length;\nn_ingredients_db = ingredientsDB.length;\n// cost_ingredients = new Array(n_ingredients);\nvar cost_total = 0;\n\nvar i; \nvar j;\n\nvar ingredient;\nvar amount;\n\n\nfor (j=0; j < n_ingredients;j++){\n\n    ingredient = ingredients[j].Product;\n    amount = ingredients[j].kg;\n    \n\n    for (i=0; i < n_ingredients_db;i++){\n\n        if(ingredient == ingredientsDB[i].Product){\n            cost_total += ingredientsDB[i].CO2 * amount;\n            // cost_ingredients[j] = ingredientsDB[i].CO2 * amount;\n            ingredients[j].CO2 = ingredientsDB[i].CO2 * amount\n            // ingredients[j].CO3 = amount\n\n            break;\n        }\n    }\n}\n\n// msg_new.payload.ingredients = ingredients\nmsg.payload.cost_total = cost_total\n// msg.payload = msg_new.payload\n// // define payload\n// msg.payload = {\n    \n//     \"ingredients\": [\n// \t\t\t{\n//                 \"Product\": \"Beef\",\n// \t\t\t\t\"CO2\":13.9\n// \t\t\t},\n// \t\t\t{\n// \t\t\t\t\"Product\": \"Lamb\",\n// \t\t\t\t\"C02\":5.3\n// \t\t\t}\n// \t\t]\n\n// }\n\nreturn msg;","outputs":1,"noerr":0,"x":640,"y":240,"wires":[["29013ec4.1346c2","e0cf1595.a6a208"]]}]